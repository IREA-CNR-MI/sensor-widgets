define(["SOS","text!svg/bearing.svg","widget/common"],function(e,t,r){var s=["service","offering","feature","property","refresh_interval"];return{inputs:s,init:function(s,i){function n(){e.getObservation(s.offering,[s.feature],[s.property],"latest",a)}function a(t){if(1==t.length&&"deg"==t[0].result.uom&&"number"==typeof t[0].result.value){{var n=t[0],a=n.featureOfInterest.name.value,l=new Date(n.resultTime),y=n.result.value;n.procedure}i.querySelector(".error").style.display="none",u.style.visibility=o.style.visibility="visible",i.querySelector(".feature_name").innerHTML=a,i.querySelector(".request_time").innerHTML=r.date.display(new Date),i.querySelector(".result_time").innerHTML=r.date.display(l),i.querySelector(".result_value").innerHTML=y,u.setAttribute("transform","rotate("+y+", 256, 256)"),o.setAttribute("transform","translate(5, 5) rotate("+y+", 256, 256)"),e.describeSensor(n.procedure,function(e){var t=e.hasOwnProperty("ProcessModel")?e.ProcessModel.outputs.OutputList.output:e.System.outputs.OutputList.output;for(var r in t){var n=t[r];n.Quantity.definition==s.property&&(i.querySelector(".property_name").innerHTML=n.name)}})}else u.style.visibility=o.style.visibility="hidden",i.querySelector(".error").style.display="block"}var l='<div class="bearing widget">';l+='<h1 class="feature_name"></h1>',l+=t,l+='<div class="error" style="display:none;text-align:center;">(no data)</div>',l+='<h2><span class="property_name"></span>:<br/><span class="result_value"></span> deg</h2>',l+='<h3>Request time:<br/><span class="request_time"></span></h3>',l+='<h3>Result time:<br/><span class="result_time"></span></h3>',l+="</div>",i.innerHTML=l;var u=i.querySelector(".arrow"),o=i.querySelector(".shadow");u.style.visibility=o.style.visibility="hidden",e.setUrl(s.service),setInterval(n,1e3*s.refresh_interval),n()}}});